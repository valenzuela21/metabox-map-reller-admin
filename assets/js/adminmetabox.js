(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{42:function(e,t,a){"use strict";a.r(t);var s=a(0),o=a(17),i=a.n(o),n=a(2);const l=window.location.hostname,r=window.location.protocol;let d,c,p,u,m,h=window.location.href,v=h.substr(h.indexOf("?post="));v=v.split("&"),v=v[0].split("="),"localhost"===l?(p=`${r}//${l}:8888/tiendaubicacion/wp-content/plugins/metabox-master-tendero/includes/Api/consult_map_xml.php?id=${v[1]}`,d=`${r}//${l}:8888/tiendaubicacion/wp-content/plugins/metabox-master-tendero/includes/Api/consult_country_json.php?id=${v[1]}`,c=`${r}//${l}:8888/tiendaubicacion/wp-content/plugins/metabox-master-tendero/includes/Api/delete_country.php`,u=`${r}//${l}:8888/tiendaubicacion/wp-content/plugins/metabox-master-tendero/includes/Api/insert_country.php`,m=`${r}//${l}:8888/tiendaubicacion/wp-content/plugins/metabox-master-tendero/includes/Api/modify_country.php`):(p=`${r}//${l}/wp-content/plugins/metabox-master-tendero/includes/Api/consult_map_xml.php?id=${v[1]}`,d=`${r}//${l}/wp-content/plugins/metabox-master-tendero/includes/Api/consult_country_json.php?id=${v[1]}`,c=`${r}//${l}/wp-content/plugins/metabox-master-tendero/includes/Api/delete_country.php`,u=`${r}//${l}/wp-content/plugins/metabox-master-tendero/includes/Api/insert_country.php`,m=`${r}//${l}/wp-content/plugins/metabox-master-tendero/includes/Api/modify_country.php`),s.default.prototype.urlGeneralConsult=d,s.default.prototype.urlGeneralDelete=c,s.default.prototype.urlGeneralMap=p,s.default.prototype.urlInsert=u,s.default.prototype.urlUpdate=m;var g={name:"GoogleMapLoader",props:{mapConfig:Object,apiKey:String},data:()=>({google:null,map:null,refresh:!1}),computed:Object(n.c)({countPlusLocalState(e){return this.refresh=e.refresh,this.refresh}}),mounted(){this.googleMaps()},updated(){!0===this.refresh&&this.resetMap()},methods:{...Object(n.b)(["GET_REFRESH"]),async googleMaps(){const e=await i()({libraries:["places"],apiKey:this.apiKey});this.google=e,this.initializeMap()},initializeMap(){const e=this.$refs.googleMap;this.map=new this.google.maps.Map(e,{zoom:8,center:{lat:8.7753527,lng:-79.9467351},mapTypeControl:!1})},resetMap(){this.refreshMarker(),this.updateRefresh()},refreshMarker(){const e=this.$refs.googleMap,t=new google.maps.Map(e,{zoom:8,center:{lat:8.7753527,lng:-79.9467351},mapTypeControl:!1});this.downloadUrl(this.urlGeneralMap,e=>{let a=e.responseXML.documentElement.getElementsByTagName("marker");Array.prototype.forEach.call(a,(function(e){let a=new google.maps.LatLng(parseFloat(e.getAttribute("lat")),parseFloat(e.getAttribute("lng")));new google.maps.Marker({map:t,position:a})}))})},downloadUrl(e,t){let a=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=this.doNothing,t(a,a.status))},a.open("GET",e,!0),a.send(null)},doNothing(){},updateRefresh(){this.$store.commit("GET_REFRESH",!1)}}},f=a(1),b=Object(f.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"googleMap",staticClass:"google-map",attrs:{id:"google-map"}}),e._v(" "),Boolean(this.google)&&Boolean(this.map)?[e._t("default",null,{google:e.google,map:e.map})]:e._e(),e._v(" "),a("v-main",{directives:[{name:"show",rawName:"v-show",value:!0===e.countPlusLocalState,expression:"countPlusLocalState === true"}]},[e._v(" Actualizado ...")])],2)}),[],!1,null,null,null).exports,_={name:"GoogleMapMarker",props:{google:{type:Object,required:!0},map:{type:Object,required:!0},marker:{type:Object,required:!0}},mounted(){const{Marker:e}=this.google.maps;new e({position:{lat:parseFloat(this.marker.lat),lng:parseFloat(this.marker.lng)},marker:this.marker,map:this.map})},render(){}},y=Object(f.a)(_,undefined,undefined,!1,null,null,null).exports,w=a(4),x=a.n(w);var $=new s.default,E={name:"GoogleGeocode",props:{google:{type:Object,required:!0},map:{type:Object,required:!0},marker:{type:Object,required:!1}},data:function(){return{infodate:[],visible:!1,disabled:!1,refresh:!1}},computed:{...Object(n.c)(["address"]),address:{get(){return this.$store.state.address},set(e){this.$store.commit("GET_ADDRESS",e)}}},methods:{...Object(n.b)(["GET_INFOADRESS","GET_REFRESH"]),searchMap:function(){const e=new this.google.maps.Map(document.getElementById("google-map"),{zoom:8,center:{lat:8.7753527,lng:-79.9467351},mapTypeControl:!1}),t=new this.google.maps.Geocoder;this.gecoderAddress(t,e)},changeDate:function(e){setTimeout(()=>{let t=e.target.value;this.$store.commit("GET_ADDRESS",t)},500)},onInputAdrress:function(){const e=this.$refs.pacinput,t=new google.maps.places.Autocomplete(e);t.setFields(["address_components","geometry","icon","name"]);const a=[];t.addListener("place_changed",()=>{const e=t.getPlace();for(const t of e.address_components){const e=t.types[0];a[e]=t.long_name}}),this.infodate=a},gecoderAddress:function(e,t){const a=this.$store.state.address;e.geocode({address:a},(e,a)=>{if("OK"===a){t.setCenter(e[0].geometry.location),new google.maps.Marker({map:t,position:e[0].geometry.location});let a=e[0].geometry.location.lat(),s=e[0].geometry.location.lng();this.infodate.latitude=a,this.infodate.longitude=s;let{country:o,locality:i,postal_code:n,route:l,street_number:r,sublocality_level_1:d,latitude:c,longitude:p}=this.infodate;void 0===o&&(o=""),void 0===i&&(i=""),void 0===n&&(n=""),void 0===l&&(l=""),void 0===r&&(r=""),void 0===d&&(d=""),void 0===c&&(c=""),void 0===p&&(p=""),this.$store.commit("GET_INFOADRESS",[o,i,n,l,r,d,c,p]),this.visible=!0,this.disabled=!0}else alert("Geocode was not successful for the following reason: "+a)})},refreshMap:function(){this.address="",this.disabled=!1,this.visible=!1,this.$store.commit("GET_REFRESH",!0)},addMakermap:function(){let e=this.$store.state.infogeneral,t=window.location.href,a=t.substr(t.indexOf("?post="));a=a.split("&"),a=a[0].split("="),x.a.post(this.urlInsert,{id_post:a[1],country:e[0],locality:e[1],postal_code:e[2],route:e[3],street_number:e[4],sublocality_level_1:e[5],latitude:e[6],longitude:e[7]}).then(e=>{console.log("Se ha insertado correctamente: "),$.$emit("consult-table",!0),this.$store.commit("GET_REFRESH",!0)}).catch((function(e){console.log(e)})),this.address="",this.disabled=!1,this.visible=!1}}},M={name:"TravelMap",components:{GoogleMapLoader:b,GoogleMapMarker:y,GoogleGeocode:Object(f.a)(E,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{staticClass:"grey lighten-5  container-margin-top"},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"column-input-search",attrs:{md:"8"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.address,expression:"address"}],ref:"pacinput",staticClass:"input-search-address",attrs:{type:"text",disabled:!0===e.disabled,placeholder:"Ingresa la dirección"},domProps:{value:e.address},on:{change:function(t){return e.changeDate(t)},keydown:function(t){return e.onInputAdrress(t)},input:function(t){t.target.composing||(e.address=t.target.value)}}}),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:!0===e.visible,expression:"visible === true"}],staticClass:"btn-refresh",attrs:{type:"button",value:"Refrescar"},on:{click:e.refreshMap}},[a("em",{staticClass:"figure-refresh"})])]),e._v(" "),!1===e.visible?a("v-col",{attrs:{md:"2"}},[a("input",{staticClass:"input-button-address",attrs:{type:"button",value:"Buscar"},on:{click:e.searchMap}})]):a("v-col",{attrs:{md:"3"}},[a("input",{staticClass:"search-buttom",attrs:{type:"button",value:"Adjuntar Tendero"},on:{click:e.addMakermap}})])],1)],1)],1)}),[],!1,null,"1917ecad",null).exports},data:()=>({markers:[],start:!1}),mounted(){this.initialize()},methods:{initialize(){x.a.get(this.urlGeneralConsult).then(e=>this.markers=e.data)}}},k={name:"App",components:{TravelMap:Object(f.a)(M,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GoogleMapLoader",{attrs:{apiKey:"AIzaSyAbz4NWK8NfeybeMGfBqQyablVMv2Xm0Lw"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.google,o=t.map;return[a("GoogleGeocode",{attrs:{google:s,map:o}}),e._v(" "),e._l(e.markers,(function(e){return a("GoogleMapMarker",{key:e.id,attrs:{marker:e,google:s,map:o}})}))]}}])})],1)}),[],!1,null,null,null).exports},data:()=>({page:1,pageCount:0,itemsPerPage:10,search:"",refresh:!1,showModal:!1,loader:!1,headers:[{text:"Ciudad",value:"city",sortable:!1},{text:"Dirección",value:"address",sortable:!1},{text:"Zip",value:"zip",sortable:!1},{text:"Pais",value:"country",sortable:!1},{text:"Latitud",value:"lat",sortable:!1},{text:"Longitud",align:"start",sortable:!1,value:"lng"},{text:"Actions",value:"actions",sortable:!1}],desserts:[],editedIndex:-1,editedItem:{city:"",address:"",zip:0,country:0,lat:0,lng:0},defaultItem:{city:"",address:"",zip:0,country:0,lat:0,lng:0}}),created(){$.$on("consult-table",e=>{1==e&&this.initialize()}),this.initialize()},methods:{...Object(n.b)(["GET_REFRESH"]),initialize(){this.loader=!0,x.a.get(this.urlGeneralConsult).then(e=>{this.desserts=e.data.reverse(),this.loader=!1})},editItem(e){this.editedIndex=this.desserts.indexOf(e),this.editedItem=Object.assign({},e),this.showModal=!0},deleteItem(e){const t=this.desserts.indexOf(e);let a=e.id;1==confirm("Deseas eliminar esta ubicación.")?(this.loader=!0,x.a.post(this.urlGeneralDelete,{id_data:a}).then(e=>{console.log("Eliminado ubicación correctamente"),this.desserts.splice(t,1),setTimeout(()=>{this.$store.commit("GET_REFRESH",!0),this.loader=!1},1e3)})):this.loader=!1},close(){this.showModal=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){if(this.editedIndex>-1){Object.assign(this.desserts[this.editedIndex],this.editedItem);let{address:e,city:t,country:a,id:s,id_post:o,lat:i,lng:n,type:l,zip:r}=this.editedItem;this.loader=!0,x.a.post(this.urlUpdate,{address:e,city:t,country:a,id:s,id_post:o,lat:i,lng:n,type:l,zip:r}).then(e=>{this.loader=!1,console.log("Se ha modificado correctamente")})}this.close()}}},I=Object(f.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-main",[a("TravelMap",{staticClass:"travel-map"})],1),e._v(" "),a("v-main",[a("v-text-field",{staticClass:"buttom-search-table",attrs:{"append-icon":"mdi-magnify",label:"Buscar Tenderos","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),e.showModal?a("v-main",{on:{close:function(t){e.showModal=!1}}},[a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[a("v-card-title",{staticClass:"headline"},[e._v("Editar")]),e._v(" "),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Dirección"},model:{value:e.editedItem.address,callback:function(t){e.$set(e.editedItem,"address",t)},expression:"editedItem.address"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Ciudad"},model:{value:e.editedItem.city,callback:function(t){e.$set(e.editedItem,"city",t)},expression:"editedItem.city"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Country"},model:{value:e.editedItem.country,callback:function(t){e.$set(e.editedItem,"country",t)},expression:"editedItem.country"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Latitud"},model:{value:e.editedItem.lat,callback:function(t){e.$set(e.editedItem,"lat",t)},expression:"editedItem.lat"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Longitud"},model:{value:e.editedItem.lng,callback:function(t){e.$set(e.editedItem,"lng",t)},expression:"editedItem.lng"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{staticClass:"text-input",attrs:{label:"Zip Code"},model:{value:e.editedItem.zip,callback:function(t){e.$set(e.editedItem,"zip",t)},expression:"editedItem.zip"}})],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("Save")])],1)],1)])])])],1):e._e(),e._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.desserts,search:e.search,page:e.page,"items-per-page":e.itemsPerPage,"hide-default-footer":"","sort-by":"calories"},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"item.actions",fn:function(t){var s=t.item;return[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s)}}},[e._v("\n                    mdi-pencil\n                ")]),e._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(s)}}},[e._v("\n                    mdi-delete\n                ")])]}},{key:"no-data",fn:function(){return[a("p",[e._v("No hay datos disponibles en este tendero")])]},proxy:!0}])}),e._v(" "),a("div",{staticClass:"text-center pt-2"},[a("v-pagination",{attrs:{length:e.pageCount},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}),e._v(" "),a("p",[e._v("Item por pagina")]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.itemsPerPage,expression:"itemsPerPage"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.itemsPerPage=t.target.multiple?a:a[0]}}},[a("option",{attrs:{selected:"",value:"5"}},[e._v("Seleccione un elemento")]),e._v(" "),a("option",{attrs:{value:"10"}},[e._v("10")]),e._v(" "),a("option",{attrs:{value:"15"}},[e._v("15")]),e._v(" "),a("option",{attrs:{value:"20"}},[e._v("20")]),e._v(" "),a("option",{attrs:{value:"50"}},[e._v("50")]),e._v(" "),a("option",{attrs:{value:"50"}},[e._v("100")])])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!0===e.loader,expression:"loader === true"}],staticClass:"loader-map"},[e._m(0)])],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{margin:"auto",color:"#636363"}},[t("div",{staticClass:"lds-ripple"},[t("div"),t("div")]),this._v(" "),t("p",[this._v("Cargando...")])])}],!1,null,null,null).exports;s.default.use(n.a);var C=new n.a.Store({state:{address:"",refresh:!1,infogeneral:[]},mutations:{GET_ADDRESS(e,t){e.address=t},GET_INFOADRESS(e,t){e.infogeneral=t},GET_REFRESH(e,t){e.refresh=t}}}),G=a(8),S=a.n(G);s.default.use(S.a);var A=new S.a({theme:{disable:!0}});s.default.config.productionTip=!1,new s.default({el:"#vue-metaboxes-app",vuetify:A,store:C,render:e=>e(I)})}},[[42,0,1]]]);